# Claude Agent Desktop

Десктопное приложение для Mac и Windows — AI-ассистент на базе Claude с поддержкой Excel, поиска и выполнения кода.

## Скриншоты

```
┌──────────────────────────────────────────────────────┐
│  Claude Agent v1.0          Claude 3.5 Haiku  ● Подключен │
│                              [Новый чат] [Настройки] │
├──────────────────────────────────────────────────────┤
│                                                       │
│  ℹ️ Добро пожаловать в Claude Agent!                  │
│                                                       │
│                    ┌─────────────────────────────┐    │
│                    │ 🧑 Вы                        │    │
│                    │ Создай Excel с продажами     │    │
│                    └─────────────────────────────┘    │
│  ┌───────────────────────────────────────┐            │
│  │ 🤖 Ассистент                          │            │
│  │ ✓ Excel создан: outputs/sales.xlsx    │            │
│  │ 15 строк, 4 колонки                  │            │
│  └───────────────────────────────────────┘            │
│                                                       │
├──────────────────────────────────────────────────────┤
│  [  Введите сообщение...                   ] [Отправить] │
└──────────────────────────────────────────────────────┘
```

## Структура проекта

```
claude-agent-desktop/
├── claude_agent_gui.py      # GUI приложение (главный файл)
├── claude_agent_v3.py       # Движок агента (tools, LangChain)
├── requirements.txt         # Зависимости
├── build.py                 # Скрипт сборки .exe / .app
├── settings.json            # Настройки (создаётся автоматически)
├── outputs/                 # Выходные файлы агента
└── work/                    # Рабочая директория
```

## Быстрый старт

### 1. Установка зависимостей

```bash
pip install -r requirements.txt
```

### 2. Запуск

```bash
python claude_agent_gui.py
```

### 3. Настройка

1. Нажмите **«Настройки»** в правом верхнем углу
2. Введите **API-ключ** (от ProxyAPI, OpenAI или Anthropic-совместимого прокси)
3. Выберите **модель Claude** из списка
4. Укажите **Base URL** вашего API-прокси
5. Нажмите **«Сохранить»**

## Сборка приложения

### Windows (.exe)

```bash
pip install pyinstaller
python build.py windows
```

Результат: `dist/Claude Agent.exe`

### macOS (.app)

```bash
pip install pyinstaller
python build.py macos
```

Результат: `dist/Claude Agent.app`

### Авто-определение ОС

```bash
python build.py
```

## Модели Claude

| Название | ID | Описание |
|----------|-----|----------|
| Claude 4 Opus | `anthropic/claude-4-opus-20250514` | Самая мощная |
| Claude 4 Sonnet | `anthropic/claude-sonnet-4-20250514` | Баланс скорости и качества |
| Claude 3.5 Sonnet | `anthropic/claude-3-5-sonnet-20241022` | Отличное соотношение цена/качество |
| Claude 3.5 Haiku | `anthropic/claude-3-5-haiku-20241022` | Самая быстрая и дешёвая |

## Быстрые команды

| Команда | Описание |
|---------|----------|
| `/help` | Справка |
| `/files` | Список файлов в outputs/ |
| `/clear` | Очистить чат |
| `/settings` | Открыть настройки |
| `/model` | Показать текущую модель |

## Возможности агента

- **Поиск в интернете** — DuckDuckGo
- **Excel** — создание, чтение, редактирование, формулы, стили, сводные таблицы
- **Python** — выполнение кода (с sandbox-ограничениями)
- **Bash** — выполнение команд (с защитой от деструктивных операций)
- **Файлы** — создание, чтение, конвертация CSV → Excel
- **Память** — контекст сохраняется в рамках сессии

## Безопасность

- Bash: заблокированы `rm -rf /`, `sudo`, `fork bomb`, `curl|bash` и др.
- Python: запрещены `socket`, `http.server`, `smtplib` и другие сетевые модули
- Файлы: path traversal невозможен, запись только в `outputs/`
- API-ключ хранится в `settings.json` локально (не передаётся третьим лицам)

## Требования

- Python 3.9+
- macOS 10.15+ или Windows 10+
- API-ключ от Claude-совместимого прокси

## Лицензия

MIT
